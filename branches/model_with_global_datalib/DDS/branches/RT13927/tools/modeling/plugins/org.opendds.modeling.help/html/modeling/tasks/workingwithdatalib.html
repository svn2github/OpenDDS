<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">

<html>
<head>
  <title>Working with Data Libraries</title>
  <link rel="stylesheet" type="text/css" href="../../styles.css">
</head>

<body>
  <h2>Working with Data Libraries</h2>

  <p>Data libraries are where you define the Structs and supporting
  types. The Structs can be then be used as the Topic type in DCPS
  Libraries.</p>

  <h3>Creating Data Libraries</h3>

  <p>From the main diagram a Data Library can be created by either
  double-clicking on the DataLib tool in the palette, or by
  clicking on the DataLib tool and then dragging the region on the
  diagram surface that the Data library figure should occupy. After
  that specify the name to use for the library.</p>

  <p>The library can then be opened by double-clicking on the
  library. A new diagram editor will be opened (using the same
  diagram file used for the main diagram).</p>

  <h3>Adding Types</h3>

  <div id="note">
    <p>You will be connecting a number of the types together so it
    could be helpful to <a href=
    "workingwithdiagrams.html#connecting_figures">review how to
    make connections</a> if you're not familiar with how to do
    so.</p>
  </div>

  <h4>Basic Types</h4>

  <p>Ultimately, basic types like Long, Octet, or String, must be
  referred to by the other types. When using connectors an option
  is to add these basic types to the diagram and later connect to
  these types. Alternatively, you can quickly create basic types on
  the fly as they are needed using the figure connector handles.
  (You can have multiple figures of the same basic type on the same
  diagram if you wish.)</p>

  <div id="note">
    <p>Basic types need to be added to the diagram even though they
    may only be used as a Field type in Structs or Unions and
    therefore not be the target of any connectors.</p>
  </div>

  <h4>Types with Fields</h4>

  <p>Struct and Union have Fields which are named references to
  types (similar to class attributes). To add a Field, click on the
  Field tool in the palette and then click on the Struct or Union
  to contain the Field. You then fill out the Field using the form
  "name: type". For example, to indicate that a Field is to be
  named count and that points to a Long you would enter "count:
  Long". The type can be from any of the active DataLibs in
  addition to the types in the currently opened diagram.</p>

  <h4>Structs</h4>

  <p>Structs with attribute isDcpsDataType set to true are
  candidate types to use for Topic types. An example Struct is
  shown below.</p><img alt="Example Struct" src=
  "../images/datalib_struct_example.png">

  <p>A Struct is created by selecting a Struct from the palette and
  adding to the diagram.</p>

  <p>After giving your Struct a name you will then want to give it
  Fields as discussed above.</p>

  <p>After you define the Fields for the Struct you may want to
  re-order them. You can do so by dragging a field and dropping it
  into the new position.</p>

  <p>Keys for the Struct are created similar to how Fields are
  created. Select the Key tool from the palette and add it to the
  Struct. Then in the Struct figure type the name of the Field that
  should be used for the Key. Similar to how Fields can be
  re-ordered, Keys can be re-ordered by dragging and dropping.</p>

  <h4>Array and Sequence Types</h4>

  <p>For collection types Array and Sequence, the type used for the
  collection must be specified. This is done by connecting the
  Array or Sequence to the type of the collection.</p>

  <p>An example of a Sequence of Structs is shown
  below.</p><img alt="Example Sequence" src=
  "html/modeling/images/datalib_sequence_example.png">

  <h4>Unions</h4>

  <p>Unions contains Branches to hold a list of Cases along with a
  Field to apply if any of the Case literals matches with switch
  specification.</p>

  <p>These Branches and Cases as placed in collapsable compartments
  are shown in the example below.</p><img alt="Union Example" src=
  "../images/datalib_union_example.png">

  <p>This example corresponds to the IDL:</p>
  <pre>
union U switch (char) {
case 'L':
    long long_mem;
case 'c':
case 'C':
    char char_mem;
default:
    string string_mem;
};
</pre>

  <h3>Validation of Data Types</h3>

  <p>Before using your Data library you should have validations
  performed first. See <a href=
  "performingvalidations.html">Performing Validations</a> to learn
  how to do validations.</p>
</body>
</html>
